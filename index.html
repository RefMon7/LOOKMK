<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>2D Tycoon</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body {
        margin: 0;
        font-family: 'Segoe UI', sans-serif;
        background: #222;
        color: #fff;
        overflow: hidden;
    }

    canvas {
        display: block;
        background: #333;
    }

    /* HUD */
    #hud {
        position: fixed;
        top: 10px;
        left: 10px;
        font-size: 20px;
        background: rgba(0,0,0,0.5);
        padding: 10px 15px;
        border-radius: 10px;
        z-index: 10;
    }

    /* –ú–∞–≥–∞–∑–∏–Ω */
    #shop {
        position: fixed;
        right: 10px;
        top: 10px;
        width: 220px;
        background: rgba(0,0,0,0.6);
        padding: 10px;
        border-radius: 10px;
        z-index: 10;
    }
    .shop-item {
        margin: 8px 0;
        padding: 8px;
        background: rgba(255,255,255,0.1);
        border-radius: 8px;
        cursor: pointer;
    }
    .shop-item:hover {
        background: rgba(255,255,255,0.2);
    }
</style>
</head>
<body>

<div id="hud">üí∞ –î–µ–Ω—å–≥–∏: <span id="money">0</span></div>
<div id="shop"></div>
<canvas id="game"></canvas>

<script>
/* ------------------- –î–ê–ù–ù–´–ï ------------------- */
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let money = 100;
let income = 0;
const GRID_SIZE = 6;       // 6x6 –∫–ª–µ—Ç–æ–∫
const TILE_SIZE = 80;      // —Ä–∞–∑–º–µ—Ä –∫–ª–µ—Ç–∫–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
const tiles = [];          // –º–∞—Å—Å–∏–≤ –∫–ª–µ—Ç–æ–∫

const buildings = [
    {name: "–ü–∞–ª–∞—Ç–∫–∞", cost: 50, income: 5, color: "#4caf50"},
    {name: "–õ–∞—Ä—ë–∫", cost: 120, income: 15, color: "#2196f3"},
    {name: "–ú–∞–≥–∞–∑–∏–Ω", cost: 300, income: 35, color: "#ff9800"},
    {name: "–§–∞–±—Ä–∏–∫–∞", cost: 700, income: 80, color: "#9c27b0"}
];

/* ------------------- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ------------------- */
canvas.width = GRID_SIZE * TILE_SIZE;
canvas.height = GRID_SIZE * TILE_SIZE;

for(let y=0; y<GRID_SIZE; y++){
    for(let x=0; x<GRID_SIZE; x++){
        tiles.push({x, y, level: -1});
    }
}

/* ------------------- –†–ò–°–û–í–ê–ù–ò–ï ------------------- */
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // –∫–ª–µ—Ç–∫–∏
    tiles.forEach(tile => {
        ctx.fillStyle = tile.level >= 0 ? buildings[tile.level].color : "#555";
        ctx.fillRect(tile.x*TILE_SIZE, tile.y*TILE_SIZE, TILE_SIZE-2, TILE_SIZE-2);
        ctx.strokeStyle = "#222";
        ctx.strokeRect(tile.x*TILE_SIZE, tile.y*TILE_SIZE, TILE_SIZE-2, TILE_SIZE-2);
    });
}

draw();

/* ------------------- –ú–ê–ì–ê–ó–ò–ù ------------------- */
const shopDiv = document.getElementById("shop");

function renderShop(){
    shopDiv.innerHTML = "<h3>–ú–∞–≥–∞–∑–∏–Ω</h3>";
    buildings.forEach((b,i)=>{
        const item = document.createElement("div");
        item.className = "shop-item";
        item.innerHTML = `<b>${b.name}</b><br>–¶–µ–Ω–∞: ${b.cost}<br>–î–æ—Ö–æ–¥: +${b.income}`;
        item.onclick = () => selectedBuilding = i;
        shopDiv.appendChild(item);
    });
}

let selectedBuilding = 0;
renderShop();

/* ------------------- –û–ë–†–ê–ë–û–¢–ö–ê –ö–õ–ò–ö–û–í ------------------- */
canvas.addEventListener('click', function(e){
    const rect = canvas.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;

    const x = Math.floor(mx / TILE_SIZE);
    const y = Math.floor(my / TILE_SIZE);

    const tile = tiles.find(t=>t.x===x && t.y===y);
    if(!tile) return;

    const nextLevel = tile.level + 1;
    if(nextLevel !== selectedBuilding) return; // —Å—Ç—Ä–æ–∏–º —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ

    const b = buildings[nextLevel];
    if(money < b.cost) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!");

    tile.level++;
    money -= b.cost;
    income += b.income;

    updateHUD();
    draw();
});

/* ------------------- –î–û–•–û–î ------------------- */
function updateHUD(){
    document.getElementById("money").innerText = money;
}

setInterval(()=>{
    money += income;
    updateHUD();
}, 3000);

updateHUD();
</script>
</body>
</html>